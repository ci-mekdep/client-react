// ** Next Import
import Link from 'next/link'

// ** MUI Imports
import IconButton from '@mui/material/IconButton'
import Box, { BoxProps } from '@mui/material/Box'
import { styled } from '@mui/material/styles'

// ** Type Import
import { LayoutProps } from 'src/shared/layouts/types'

// ** Custom Icon Import
import Icon from 'src/shared/components/icon'

interface Props {
  navHover: boolean
  collapsedNavWidth: number
  hidden: LayoutProps['hidden']
  navigationBorderWidth: number
  toggleNavVisibility: () => void
  settings: LayoutProps['settings']
  saveSettings: LayoutProps['saveSettings']
  navMenuBranding?: LayoutProps['verticalLayoutProps']['navMenu']['branding']
  menuLockedIcon?: LayoutProps['verticalLayoutProps']['navMenu']['lockedIcon']
  menuUnlockedIcon?: LayoutProps['verticalLayoutProps']['navMenu']['unlockedIcon']
}

// ** Styled Components
const MenuHeaderWrapper = styled(Box)<BoxProps>(({ theme }) => ({
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'space-between',
  paddingRight: theme.spacing(3.5),
  transition: 'padding .25s ease-in-out',
  minHeight: theme.mixins.toolbar.minHeight
}))

const LinkStyled = styled(Link)({
  display: 'flex',
  alignItems: 'center',
  textDecoration: 'none'
})

const VerticalNavHeader = (props: Props) => {
  // ** Props
  const {
    hidden,
    navHover,
    settings,
    saveSettings,
    collapsedNavWidth,
    toggleNavVisibility,
    navigationBorderWidth,
    menuLockedIcon: userMenuLockedIcon,
    navMenuBranding: userNavMenuBranding,
    menuUnlockedIcon: userMenuUnlockedIcon
  } = props

  // ** Hooks & Vars
  const { navCollapsed } = settings

  const menuCollapsedStyles = navCollapsed && !navHover ? { opacity: 0 } : { opacity: 1 }

  const menuHeaderPaddingLeft = () => {
    if (navCollapsed && !navHover) {
      if (userNavMenuBranding) {
        return 0
      } else {
        return (collapsedNavWidth - navigationBorderWidth - 34) / 8
      }
    } else {
      return 6
    }
  }

  const MenuLockedIcon = () => userMenuLockedIcon || <Icon icon='tabler:circle-dot' />

  const MenuUnlockedIcon = () => userMenuUnlockedIcon || <Icon icon='tabler:circle' />

  return (
    <MenuHeaderWrapper className='nav-header' sx={{ pl: menuHeaderPaddingLeft() }}>
      {userNavMenuBranding ? (
        userNavMenuBranding(props)
      ) : (
        <LinkStyled href='/'>
          <svg height={34} viewBox='0 0 36 40' fill='none' xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M33.4822 8.38909L20.0563 0.589763C19.3912 0.203403 18.6367 0 17.8687 0C17.1007 0 16.3462 0.203403 15.6811 0.589763L2.25523 8.38909C1.59013 8.77544 1.03783 9.33113 0.653821 10.0003C0.269818 10.6695 0.0676465 11.4286 0.067627 12.2013V27.7999C0.0677167 28.5727 0.269912 29.3318 0.653904 30.0011C1.0379 30.6703 1.59016 31.2261 2.25523 31.6126L15.6811 39.4103C16.3462 39.7966 17.1007 40 17.8687 40C18.6367 40 19.3912 39.7966 20.0563 39.4103L33.4822 31.6121C34.8358 30.8252 35.6698 29.3726 35.6698 27.7994V12.2013C35.6697 11.4286 35.4674 10.6695 35.0834 10.0004C34.6994 9.33123 34.1472 8.77553 33.4822 8.38909ZM17.8687 4.40194L29.107 10.9307L17.8698 17.4584L6.63044 10.9307L17.8687 4.40194ZM4.44283 27.7999V14.7429L15.6811 21.2711V34.3276L4.44283 27.7999ZM20.0563 34.3271V21.2717L31.2946 14.744V27.8005L20.0563 34.3271Z'
              fill='#3F7CF2'
            />
          </svg>
          <Box sx={{ ...menuCollapsedStyles, ...(navCollapsed && !navHover ? {} : { ml: 1.8, mt: 1.5 }) }}>
            <svg width={102} viewBox='0 0 119 28' fill='none' xmlns='http://www.w3.org/2000/svg'>
              <path
                d='M7.36444 7.21829C6.32425 7.21829 5.36727 7.40667 4.49351 7.78344C3.61975 8.16021 2.89162 8.68349 2.30911 9.33237C1.7266 9.98124 1.24812 10.7976 0.936059 11.6767C0.603198 12.5558 0.436768 13.4977 0.436768 14.5443C0.436768 15.842 0.603198 16.9514 0.956863 17.9561C1.31053 18.9399 1.76821 19.7562 2.41313 20.447C3.05805 21.1168 3.78618 21.6401 4.65994 21.9959C5.5337 22.3517 6.46988 22.5192 7.48926 22.5192C8.00936 22.5192 8.57106 22.4564 9.09116 22.3727C9.61125 22.2889 10.1313 22.1424 10.6514 21.954C11.1923 21.7866 11.6292 21.5145 12.0869 21.2214C12.5446 20.9284 12.9399 20.6354 13.2519 20.2377L12.5238 19.2748C12.399 19.0864 12.2533 19.0027 12.0245 19.0027C11.8581 19.0027 11.6708 19.0864 11.442 19.2329C11.2131 19.3795 10.9219 19.526 10.5682 19.7144C10.2146 19.8818 9.81929 20.0493 9.3408 20.1958C8.88312 20.3423 8.30061 20.4051 7.65569 20.4051C6.96917 20.4051 6.38666 20.3004 5.80415 20.0493C5.22165 19.819 4.74316 19.4632 4.34789 19.0027C3.93181 18.5422 3.57814 17.998 3.3493 17.3072C3.12046 16.5956 2.99564 15.7793 2.99564 14.8373H12.7942C13.0231 14.8373 13.2311 14.7536 13.3143 14.628C13.3975 14.5234 13.4184 14.2303 13.4184 13.8117C13.4184 12.7651 13.2519 11.8232 12.9607 11.0069C12.6694 10.1906 12.2117 9.47889 11.6708 8.91374C11.1507 8.36952 10.5058 7.95089 9.75688 7.65785C9.00794 7.36481 8.17579 7.21829 7.30203 7.21829H7.36444ZM7.36444 9.16492C7.94695 9.16492 8.50865 9.24864 8.96633 9.45796C9.44482 9.64634 9.84009 9.93938 10.173 10.2952C10.485 10.651 10.693 11.1115 10.8595 11.6139C11.0467 12.1163 11.1299 12.6814 11.1299 13.2675H3.12046C3.28689 11.9697 3.76538 10.9441 4.4519 10.2115C5.15923 9.47889 6.13701 9.12305 7.40605 9.12305L7.36444 9.16492ZM19.6595 5.43912L26.9408 18.5841C27.1697 19.0236 27.5441 19.2748 27.981 19.2748H28.3971C28.834 19.2748 29.146 19.0236 29.3957 18.5841L36.5522 5.46005C36.4898 5.94147 36.4898 6.4229 36.4898 6.84153V20.1121C35.4704 20.3004 34.8255 20.4051 34.5342 20.4679C34.243 20.5307 34.0973 20.6981 34.0973 20.9912V22.2889H41.0874V20.9912C41.0874 20.6981 40.921 20.5307 40.6297 20.4679C40.4633 20.4051 39.9016 20.3004 38.9654 20.1121V3.40877L40.6297 3.05293C40.921 3.01107 41.0874 2.82269 41.0874 2.52965V1.25283H36.9059C36.677 1.25283 36.4274 1.27376 36.3234 1.33655C36.1985 1.39935 36.0321 1.48307 35.9073 1.71332L28.8548 14.628C28.6259 15.1094 28.3971 15.6118 28.1891 16.1979C27.9394 15.4862 27.6898 14.9629 27.5233 14.6699L20.3252 1.71332C20.2212 1.48307 20.0756 1.39935 19.9508 1.33655C19.8259 1.27376 19.5971 1.25283 19.3682 1.25283H15.1659V2.52965C15.1659 2.82269 15.3531 3.01107 15.6444 3.05293C15.8108 3.11573 16.3309 3.24132 17.2671 3.40877V20.1121L15.6444 20.4679C15.3531 20.5307 15.1659 20.6981 15.1659 20.9912V22.2889H22.1352V20.9912C22.1352 20.6981 22.0103 20.5307 21.7607 20.4679C21.4902 20.4051 20.8245 20.3004 19.7843 20.1121V6.82059C19.7843 6.38103 19.7427 5.94147 19.6803 5.39726L19.6595 5.43912ZM49.4922 7.21829C48.4312 7.21829 47.4742 7.40667 46.6004 7.78344C45.7267 8.16021 44.9985 8.68349 44.416 9.33237C43.8335 9.98124 43.3758 10.7976 43.043 11.6767C42.7309 12.5558 42.5437 13.4977 42.5437 14.5443C42.5437 15.842 42.7309 16.9514 43.0846 17.9561C43.4175 18.9399 43.8959 19.7562 44.5409 20.447C45.165 21.1168 45.8931 21.6401 46.7669 21.9959C47.6406 22.3517 48.5768 22.5192 49.5962 22.5192C50.1163 22.5192 50.678 22.4564 51.1981 22.3727C51.7182 22.2889 52.2591 22.1424 52.7792 21.954C53.2993 21.7866 53.7362 21.5145 54.1938 21.2214C54.6723 20.9284 55.0468 20.6354 55.3588 20.2377L54.6307 19.2748C54.5267 19.0864 54.3811 19.0027 54.1522 19.0027C53.965 19.0027 53.7986 19.0864 53.5697 19.2329C53.3201 19.3795 53.0288 19.526 52.696 19.7144C52.3423 19.8818 51.9262 20.0493 51.4685 20.1958C50.99 20.3423 50.4075 20.4051 49.7834 20.4051C49.0761 20.4051 48.4936 20.3004 47.9111 20.0493C47.3286 19.819 46.8709 19.4632 46.4548 19.0027C46.0387 18.5422 45.7059 17.998 45.4562 17.3072C45.2274 16.5956 45.1234 15.7793 45.1234 14.8373H54.9012C55.13 14.8373 55.338 14.7536 55.4213 14.628C55.5045 14.5234 55.5461 14.2303 55.5461 13.8117C55.5461 12.7651 55.3588 11.8232 55.0676 11.0069C54.7763 10.1906 54.3187 9.47889 53.7986 8.91374C53.2785 8.36952 52.6335 7.95089 51.8638 7.65785C51.1149 7.36481 50.3035 7.21829 49.4298 7.21829H49.4922ZM49.4922 9.16492C50.0747 9.16492 50.6156 9.24864 51.0941 9.45796C51.5517 9.64634 51.9678 9.93938 52.2799 10.2952C52.5919 10.651 52.8 11.1115 52.9872 11.6139C53.1536 12.1163 53.2369 12.6814 53.2369 13.2675H45.2274C45.4146 11.9697 45.8723 10.9441 46.5796 10.2115C47.2662 9.47889 48.2647 9.12305 49.513 9.12305L49.4922 9.16492ZM71.9187 20.4679C71.7939 20.4679 71.4818 20.4051 70.9825 20.3004L70.2128 20.1749L66.1352 14.9629C65.9064 14.5443 65.6151 14.2931 65.2615 14.0419C65.5527 13.8745 65.8232 13.6024 66.1144 13.2675L69.5471 9.56261C70.504 9.39516 71.1281 9.26957 71.357 9.20678C71.5858 9.16492 71.7315 8.97653 71.7315 8.68349V7.44854H71.565H69.1726H65.5527V8.68349C65.5527 8.97653 65.74 9.18585 66.0312 9.24864C66.1352 9.26957 66.26 9.26957 66.4889 9.33237C66.6137 9.33237 66.7177 9.39516 66.8426 9.39516L63.5139 12.9744C63.2851 13.2675 62.9314 13.3721 62.5986 13.3721H61.9537V0.687679H59.3324H57.2312V1.94357C57.2312 2.23661 57.3768 2.42499 57.6681 2.46685C57.8345 2.52965 58.3962 2.65524 59.3324 2.82269V20.1539L57.6681 20.4679C57.3768 20.5307 57.2312 20.74 57.2312 21.033V22.2889H64.0548V21.033C64.0548 20.74 63.8676 20.5307 63.5764 20.4679C62.5986 20.2586 62.0577 20.1539 61.9537 20.1539V15.1932H62.6402C62.9314 15.1932 63.1811 15.2141 63.3267 15.2769C63.4723 15.3397 63.618 15.4653 63.7636 15.6537L68.5901 21.7656C68.8813 22.1006 69.1934 22.2889 69.5887 22.2889H72.314V20.9912C72.314 20.6981 72.1683 20.5307 71.8771 20.4679H71.9187ZM79.304 7.1555C77.3485 7.1555 75.7882 7.92996 74.6232 9.39516C73.479 10.7976 72.8965 12.6814 72.8965 14.9001C72.8965 17.37 73.4166 19.212 74.4152 20.5307C75.4137 21.8075 76.7452 22.4564 78.4927 22.4564C80.4066 22.4564 82.0501 21.6401 83.444 19.9446L83.6729 21.7238C83.7977 22.0796 84.0265 22.2889 84.3802 22.2889H87.9792V20.9912C87.9792 20.6981 87.8752 20.5307 87.584 20.4679C87.3967 20.4051 86.8142 20.3004 85.8989 20.1121V0.666748H80.9475V1.94357C80.9475 2.23661 81.0932 2.42499 81.3844 2.46685C81.6757 2.52965 82.3414 2.65524 83.3192 2.82269V8.91374C82.279 7.74158 80.9059 7.1555 79.2832 7.1555H79.304ZM79.3456 20.3423C78.7631 20.3423 78.2014 20.2586 77.7438 20.0493C76.2875 19.4213 75.5802 17.7049 75.5802 14.9001C75.5802 13.0791 75.9338 11.6767 76.6828 10.672C77.4525 9.6882 78.5135 9.20678 79.9282 9.20678C81.322 9.20678 82.4454 9.79286 83.3192 10.965V18.1236C82.2166 19.6097 80.8851 20.3842 79.3665 20.3842L79.3456 20.3423ZM96.1967 7.21829C95.1566 7.21829 94.1996 7.40667 93.3258 7.78344C92.4521 8.16021 91.7239 8.68349 91.1414 9.33237C90.5589 9.98124 90.0804 10.7976 89.7684 11.6767C89.4355 12.5558 89.2691 13.4977 89.2691 14.5443C89.2691 15.842 89.4355 16.9514 89.7892 17.9561C90.1428 18.9399 90.6005 19.7562 91.2454 20.447C91.8904 21.1168 92.6185 21.6401 93.4922 21.9959C94.366 22.3517 95.3022 22.5192 96.3216 22.5192C96.8417 22.5192 97.4034 22.4564 97.9235 22.3727C98.4436 22.2889 98.9637 22.1424 99.4837 21.954C100.025 21.7866 100.462 21.5145 100.919 21.2214C101.377 20.9284 101.772 20.6354 102.084 20.2377L101.356 19.2748C101.231 19.0864 101.086 19.0027 100.857 19.0027C100.69 19.0027 100.503 19.0864 100.274 19.2329C100.045 19.3795 99.7542 19.526 99.4005 19.7144C99.0469 19.8818 98.6516 20.0493 98.1731 20.1958C97.7154 20.3423 97.1329 20.4051 96.488 20.4051C95.8015 20.4051 95.219 20.3004 94.6365 20.0493C94.054 19.819 93.5755 19.4632 93.1802 19.0027C92.7641 18.5422 92.4105 17.998 92.1816 17.3072C91.9528 16.5956 91.8279 15.7793 91.8279 14.8373H101.627C101.855 14.8373 102.063 14.7536 102.147 14.628C102.23 14.5234 102.251 14.2303 102.251 13.8117C102.251 12.7651 102.084 11.8232 101.793 11.0069C101.502 10.1906 101.044 9.47889 100.503 8.91374C99.983 8.36952 99.3381 7.95089 98.5892 7.65785C97.8402 7.36481 97.0081 7.21829 96.1343 7.21829H96.1967ZM96.1967 9.16492C96.7793 9.16492 97.341 9.24864 97.7986 9.45796C98.2771 9.64634 98.6724 9.93938 99.0053 10.2952C99.3173 10.651 99.5254 11.1115 99.6918 11.6139C99.879 12.1163 99.9622 12.6814 99.9622 13.2675H91.9528C92.1192 11.9697 92.5977 10.9441 93.2842 10.2115C93.9915 9.47889 94.9693 9.12305 96.2384 9.12305L96.1967 9.16492ZM107.993 9.751L107.784 7.99275C107.68 7.63692 107.452 7.44854 107.098 7.44854H105.517H103.416V8.68349C103.416 8.97653 103.603 9.18585 103.894 9.24864C104.061 9.31144 104.581 9.41609 105.517 9.60448V25.1775L103.894 25.5124C103.603 25.5752 103.416 25.7636 103.416 26.0566V27.3334H110.239V26.0566C110.239 25.7636 110.073 25.5752 109.782 25.5124C109.719 25.5124 109.428 25.4496 108.929 25.324C108.429 25.2193 108.18 25.1565 108.138 25.1565V20.7609C109.199 21.9331 110.593 22.4982 112.403 22.4982C114.192 22.4982 115.711 21.7238 116.876 20.2586C117.978 18.8562 118.561 17.0142 118.561 14.7745C118.561 12.3465 118.041 10.4417 117.063 9.10212C116.064 7.80437 114.733 7.1555 112.985 7.1555C111.051 7.1555 109.428 8.03462 108.034 9.751H107.993ZM108.138 18.7097V11.5302C109.241 10.044 110.593 9.26957 112.112 9.26957C114.608 9.26957 115.898 11.1534 115.898 14.7745C115.898 16.5956 115.544 17.998 114.775 19.0027C114.026 20.0074 112.923 20.4679 111.529 20.4679C110.115 20.4679 109.012 19.8818 108.138 18.7097Z'
                fill='#3F7CF2'
              />
            </svg>
          </Box>
        </LinkStyled>
      )}

      {hidden ? (
        <IconButton
          disableRipple
          disableFocusRipple
          onClick={toggleNavVisibility}
          sx={{ p: 0, color: 'text.secondary', backgroundColor: 'transparent !important' }}
        >
          <Icon icon='tabler:x' fontSize='1.25rem' />
        </IconButton>
      ) : userMenuLockedIcon === null && userMenuUnlockedIcon === null ? null : (
        <IconButton
          disableRipple
          disableFocusRipple
          onClick={() => saveSettings({ ...settings, navCollapsed: !navCollapsed })}
          sx={{
            p: 0,
            color: 'text.primary',
            backgroundColor: 'transparent !important',
            '& svg': {
              fontSize: '1.25rem',
              ...menuCollapsedStyles,
              transition: 'opacity .25s ease-in-out'
            }
          }}
        >
          {navCollapsed ? MenuUnlockedIcon() : MenuLockedIcon()}
        </IconButton>
      )}
    </MenuHeaderWrapper>
  )
}

export default VerticalNavHeader
